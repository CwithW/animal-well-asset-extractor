"use strict";(self.webpackChunkasset_extractor=self.webpackChunkasset_extractor||[]).push([[206],{206:(e,t,n)=>{n.r(t),n.d(t,{Format:()=>i,NtExecutable:()=>F,NtExecutableResource:()=>Y,calculateCheckSumForPE:()=>d,version:()=>Z});var i={};n.r(i),n.d(i,{ArrayFormatBase:()=>f,FormatBase:()=>r,ImageDataDirectoryArray:()=>c,ImageDirectoryEntry:()=>l,ImageDosHeader:()=>j,ImageFileHeader:()=>z,ImageNtHeaders:()=>B,ImageOptionalHeader:()=>S,ImageOptionalHeader64:()=>C,ImageSectionHeaderArray:()=>L,findImageSectionBlockByDirectoryEntry:()=>ne,getImageDosHeader:()=>$,getImageNtHeadersByDosHeader:()=>ee,getImageSectionHeadersByNtHeaders:()=>te});const r=function(){function e(e){this.view=e}return e.prototype.copyTo=function(e,t){new Uint8Array(e,t,this.view.byteLength).set(new Uint8Array(this.view.buffer,this.view.byteOffset,this.view.byteLength))},Object.defineProperty(e.prototype,"byteLength",{get:function(){return this.view.byteLength},enumerable:!1,configurable:!0}),e}();var o,s=(o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},o(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=function(e){function t(t){return e.call(this,t)||this}return s(t,e),t.prototype.forEach=function(e){var t=this.length,n=[];n.length=t;for(var i=0;i<t;++i)n[i]=this.get(i);for(i=0;i<t;++i)e(n[i],i,this)},t.prototype._iterator=function(){return new(function(){function e(e){this.base=e,this.i=0}return e.prototype.next=function(){return this.i===this.base.length?{value:void 0,done:!0}:{value:this.base.get(this.i++),done:!1}},e}())(this)},t}(r);"undefined"!=typeof Symbol&&(a.prototype[Symbol.iterator]=a.prototype._iterator);const f=a;var u=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();const c=function(e){function t(t){var n=e.call(this,t)||this;return n.length=16,n}return u(t,e),t.from=function(e,n){return void 0===n&&(n=0),new t(new DataView(e,n,128))},t.prototype.get=function(e){return{virtualAddress:this.view.getUint32(8*e,!0),size:this.view.getUint32(4+8*e,!0)}},t.prototype.set=function(e,t){this.view.setUint32(8*e,t.virtualAddress,!0),this.view.setUint32(4+8*e,t.size,!0)},t.prototype.findIndexByVirtualAddress=function(e){for(var t=0;t<16;++t){var n=this.view.getUint32(8*t,!0),i=this.view.getUint32(4+8*t,!0);if(e>=n&&e<n+i)return t}return null},t.size=128,t.itemSize=8,t}(f);var p;!function(e){e[e.Export=0]="Export",e[e.Import=1]="Import",e[e.Resource=2]="Resource",e[e.Exception=3]="Exception",e[e.Certificate=4]="Certificate",e[e.Security=4]="Security",e[e.BaseRelocation=5]="BaseRelocation",e[e.Debug=6]="Debug",e[e.Architecture=7]="Architecture",e[e.GlobalPointer=8]="GlobalPointer",e[e.Tls=9]="Tls",e[e.TLS=9]="TLS",e[e.LoadConfig=10]="LoadConfig",e[e.BoundImport=11]="BoundImport",e[e.Iat=12]="Iat",e[e.IAT=12]="IAT",e[e.DelayImport=13]="DelayImport",e[e.ComDescriptor=14]="ComDescriptor",e[e.COMDescriptor=14]="COMDescriptor"}(p||(p={}));const l=p;function g(e){var t={};return Object.keys(e).forEach((function(n){t[n]=e[n]})),t}function h(e,t,n){if("buffer"in e){var i=e.byteOffset,r=e.byteLength;return void 0!==t&&(i+=t,r-=t),void 0!==n&&(r=n),new DataView(e.buffer,i,r)}return new DataView(e,t,n)}function d(e,t){for(var n=j.from(e),i=new DataView(e),r=n.newHeaderAddress+88,o=0,s=4294967296,a=function(e){(o+=e)>=s&&(o=o%s+(o/s|0))},f=i.byteLength,u=f%4,c=f-u,p=0;p<c;p+=4)p!==r&&a(i.getUint32(p,!0));if(0!==u){var l=0;for(p=0;p<u;p++)l|=i.getUint8(c+p)<<8*(3-p);a(l)}return o=(65535&o)+(o>>>16),o=(65535&(o+=o>>>16))+f,t&&i.setUint32(r,o,!0),o}function y(e,t){return Math.floor((e+t-1)/t)*t}function v(e,t,n,i,r){var o="buffer"in e?new Uint8Array(e.buffer,e.byteOffset+(t||0),r):new Uint8Array(e,t,r),s="buffer"in n?new Uint8Array(n.buffer,n.byteOffset+(i||0),r):new Uint8Array(n,i,r);o.set(s)}function b(e,t,n){var i=new ArrayBuffer(n);return v(i,0,e,t,n),i}function w(e){if("buffer"in e){var t=new ArrayBuffer(e.byteLength);return new Uint8Array(t).set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),t}return t=new ArrayBuffer(e.byteLength),new Uint8Array(t).set(new Uint8Array(e)),t}function m(e,t,n){for(var i=0,r=0;r<n&&0!==e.getUint8(t+r);++r)++i;if("undefined"!=typeof Buffer)return Buffer.from(e.buffer,e.byteOffset+t,i).toString("utf8");if("undefined"!=typeof decodeURIComponent){var o="";for(r=0;r<i;++r)o+=(s=e.getUint8(t+r))<16?"%0"+s.toString(16):"%"+s.toString(16);return decodeURIComponent(o)}for(o="",r=0;r<i;++r){var s=e.getUint8(t+r);o+=String.fromCharCode(s)}return o}function U(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);if("undefined"!=typeof Buffer)return("buffer"in e?Buffer.from(e.buffer,e.byteOffset,e.byteLength):Buffer.from(e)).toString("utf8");var t;if(t="buffer"in e?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e),"undefined"!=typeof decodeURIComponent){for(var n="",i=0;i<t.length;++i)n+=(r=t[i])<16?"%0"+r.toString(16):"%"+r.toString(16);return decodeURIComponent(n)}for(n="",i=0;i<t.length;++i){var r=t[i];n+=String.fromCharCode(r)}return n}function O(e){if("undefined"!=typeof TextEncoder)return w((new TextEncoder).encode(e));if("undefined"!=typeof Buffer)return w(Buffer.from(e,"utf8"));if("undefined"!=typeof encodeURIComponent){for(var t=encodeURIComponent(e),n=0,i=0;i<t.length;++n)37===(a=t.charCodeAt(i))?i+=3:++i;for(var r=new ArrayBuffer(n),o=new Uint8Array(r),s=(i=0,0);i<t.length;++s){var a;if(37===(a=t.charCodeAt(i))){var f=parseInt(t.substring(i+1,i+3),16);o[s]=f,i+=3}else o[s]=a,++i}return r}return r=new ArrayBuffer(e.length),new Uint8Array(r).set([].map.call(e,(function(e){return e.charCodeAt(0)}))),r}var A=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();const j=function(e){function t(t){return e.call(this,t)||this}return A(t,e),t.from=function(e,n){return void 0===n&&(n=0),new t(h(e,n,64))},t.prototype.isValid=function(){return this.magic===t.DEFAULT_MAGIC},Object.defineProperty(t.prototype,"magic",{get:function(){return this.view.getUint16(0,!0)},set:function(e){this.view.setUint16(0,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastPageSize",{get:function(){return this.view.getUint16(2,!0)},set:function(e){this.view.setUint16(2,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pages",{get:function(){return this.view.getUint16(4,!0)},set:function(e){this.view.setUint16(4,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"relocations",{get:function(){return this.view.getUint16(6,!0)},set:function(e){this.view.setUint16(6,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"headerSizeInParagraph",{get:function(){return this.view.getUint16(8,!0)},set:function(e){this.view.setUint16(8,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minAllocParagraphs",{get:function(){return this.view.getUint16(10,!0)},set:function(e){this.view.setUint16(10,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxAllocParagraphs",{get:function(){return this.view.getUint16(12,!0)},set:function(e){this.view.setUint16(12,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"initialSS",{get:function(){return this.view.getUint16(14,!0)},set:function(e){this.view.setUint16(14,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"initialSP",{get:function(){return this.view.getUint16(16,!0)},set:function(e){this.view.setUint16(16,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"checkSum",{get:function(){return this.view.getUint16(18,!0)},set:function(e){this.view.setUint16(18,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"initialIP",{get:function(){return this.view.getUint16(20,!0)},set:function(e){this.view.setUint16(20,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"initialCS",{get:function(){return this.view.getUint16(22,!0)},set:function(e){this.view.setUint16(22,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"relocationTableAddress",{get:function(){return this.view.getUint16(24,!0)},set:function(e){this.view.setUint16(24,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"overlayNum",{get:function(){return this.view.getUint16(26,!0)},set:function(e){this.view.setUint16(26,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oemId",{get:function(){return this.view.getUint16(36,!0)},set:function(e){this.view.setUint16(36,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oemInfo",{get:function(){return this.view.getUint16(38,!0)},set:function(e){this.view.setUint16(38,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newHeaderAddress",{get:function(){return this.view.getUint32(60,!0)},set:function(e){this.view.setUint32(60,e,!0)},enumerable:!1,configurable:!0}),t.size=64,t.DEFAULT_MAGIC=23117,t}(r);var _=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();const z=function(e){function t(t){return e.call(this,t)||this}return _(t,e),t.from=function(e,n){return void 0===n&&(n=0),new t(new DataView(e,n,20))},Object.defineProperty(t.prototype,"machine",{get:function(){return this.view.getUint16(0,!0)},set:function(e){this.view.setUint16(0,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"numberOfSections",{get:function(){return this.view.getUint16(2,!0)},set:function(e){this.view.setUint16(2,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"timeDateStamp",{get:function(){return this.view.getUint32(4,!0)},set:function(e){this.view.setUint32(4,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pointerToSymbolTable",{get:function(){return this.view.getUint32(8,!0)},set:function(e){this.view.setUint32(8,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"numberOfSymbols",{get:function(){return this.view.getUint32(12,!0)},set:function(e){this.view.setUint32(12,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfOptionalHeader",{get:function(){return this.view.getUint16(16,!0)},set:function(e){this.view.setUint16(16,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"characteristics",{get:function(){return this.view.getUint16(18,!0)},set:function(e){this.view.setUint16(18,e,!0)},enumerable:!1,configurable:!0}),t.size=20,t}(r);var P=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();const S=function(e){function t(t){return e.call(this,t)||this}return P(t,e),t.from=function(e,n){return void 0===n&&(n=0),new t(new DataView(e,n,96))},Object.defineProperty(t.prototype,"magic",{get:function(){return this.view.getUint16(0,!0)},set:function(e){this.view.setUint16(0,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"majorLinkerVersion",{get:function(){return this.view.getUint8(2)},set:function(e){this.view.setUint8(2,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minorLinkerVersion",{get:function(){return this.view.getUint8(3)},set:function(e){this.view.setUint8(3,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfCode",{get:function(){return this.view.getUint32(4,!0)},set:function(e){this.view.setUint32(4,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfInitializedData",{get:function(){return this.view.getUint32(8,!0)},set:function(e){this.view.setUint32(8,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfUninitializedData",{get:function(){return this.view.getUint32(12,!0)},set:function(e){this.view.setUint32(12,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"addressOfEntryPoint",{get:function(){return this.view.getUint32(16,!0)},set:function(e){this.view.setUint32(16,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"baseOfCode",{get:function(){return this.view.getUint32(20,!0)},set:function(e){this.view.setUint32(20,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"baseOfData",{get:function(){return this.view.getUint32(24,!0)},set:function(e){this.view.setUint32(24,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageBase",{get:function(){return this.view.getUint32(28,!0)},set:function(e){this.view.setUint32(28,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sectionAlignment",{get:function(){return this.view.getUint32(32,!0)},set:function(e){this.view.setUint32(32,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fileAlignment",{get:function(){return this.view.getUint32(36,!0)},set:function(e){this.view.setUint32(36,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"majorOperatingSystemVersion",{get:function(){return this.view.getUint16(40,!0)},set:function(e){this.view.setUint16(40,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minorOperatingSystemVersion",{get:function(){return this.view.getUint16(42,!0)},set:function(e){this.view.setUint16(42,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"majorImageVersion",{get:function(){return this.view.getUint16(44,!0)},set:function(e){this.view.setUint16(44,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minorImageVersion",{get:function(){return this.view.getUint16(46,!0)},set:function(e){this.view.setUint16(46,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"majorSubsystemVersion",{get:function(){return this.view.getUint16(48,!0)},set:function(e){this.view.setUint16(48,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minorSubsystemVersion",{get:function(){return this.view.getUint16(50,!0)},set:function(e){this.view.setUint16(50,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"win32VersionValue",{get:function(){return this.view.getUint32(52,!0)},set:function(e){this.view.setUint32(52,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfImage",{get:function(){return this.view.getUint32(56,!0)},set:function(e){this.view.setUint32(56,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfHeaders",{get:function(){return this.view.getUint32(60,!0)},set:function(e){this.view.setUint32(60,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"checkSum",{get:function(){return this.view.getUint32(64,!0)},set:function(e){this.view.setUint32(64,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"subsystem",{get:function(){return this.view.getUint16(68,!0)},set:function(e){this.view.setUint16(68,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dllCharacteristics",{get:function(){return this.view.getUint16(70,!0)},set:function(e){this.view.setUint16(70,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfStackReserve",{get:function(){return this.view.getUint32(72,!0)},set:function(e){this.view.setUint32(72,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfStackCommit",{get:function(){return this.view.getUint32(76,!0)},set:function(e){this.view.setUint32(76,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfHeapReserve",{get:function(){return this.view.getUint32(80,!0)},set:function(e){this.view.setUint32(80,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfHeapCommit",{get:function(){return this.view.getUint32(84,!0)},set:function(e){this.view.setUint32(84,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loaderFlags",{get:function(){return this.view.getUint32(88,!0)},set:function(e){this.view.setUint32(88,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"numberOfRvaAndSizes",{get:function(){return this.view.getUint32(92,!0)},set:function(e){this.view.setUint32(92,e,!0)},enumerable:!1,configurable:!0}),t.size=96,t.DEFAULT_MAGIC=267,t}(r);var D=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();function E(e,t){return 4294967296*e.getUint32(t+4,!0)+e.getUint32(t,!0)}function R(e,t,n){e.setUint32(t,4294967295&n,!0),e.setUint32(t+4,Math.floor(n/4294967296),!0)}function I(e,t){if("undefined"==typeof BigInt)throw new Error("BigInt not supported");return BigInt(4294967296)*BigInt(e.getUint32(t+4,!0))+BigInt(e.getUint32(t,!0))}function T(e,t,n){if("undefined"==typeof BigInt)throw new Error("BigInt not supported");e.setUint32(t,Number(n&BigInt(4294967295)),!0),e.setUint32(t+4,Math.floor(Number(n/BigInt(4294967296)&BigInt(4294967295))),!0)}const C=function(e){function t(t){return e.call(this,t)||this}return D(t,e),t.from=function(e,n){return void 0===n&&(n=0),new t(new DataView(e,n,112))},Object.defineProperty(t.prototype,"magic",{get:function(){return this.view.getUint16(0,!0)},set:function(e){this.view.setUint16(0,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"majorLinkerVersion",{get:function(){return this.view.getUint8(2)},set:function(e){this.view.setUint8(2,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minorLinkerVersion",{get:function(){return this.view.getUint8(3)},set:function(e){this.view.setUint8(3,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfCode",{get:function(){return this.view.getUint32(4,!0)},set:function(e){this.view.setUint32(4,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfInitializedData",{get:function(){return this.view.getUint32(8,!0)},set:function(e){this.view.setUint32(8,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfUninitializedData",{get:function(){return this.view.getUint32(12,!0)},set:function(e){this.view.setUint32(12,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"addressOfEntryPoint",{get:function(){return this.view.getUint32(16,!0)},set:function(e){this.view.setUint32(16,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"baseOfCode",{get:function(){return this.view.getUint32(20,!0)},set:function(e){this.view.setUint32(20,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageBase",{get:function(){return E(this.view,24)},set:function(e){R(this.view,24,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageBaseBigInt",{get:function(){return I(this.view,24)},set:function(e){T(this.view,24,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sectionAlignment",{get:function(){return this.view.getUint32(32,!0)},set:function(e){this.view.setUint32(32,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fileAlignment",{get:function(){return this.view.getUint32(36,!0)},set:function(e){this.view.setUint32(36,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"majorOperatingSystemVersion",{get:function(){return this.view.getUint16(40,!0)},set:function(e){this.view.setUint16(40,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minorOperatingSystemVersion",{get:function(){return this.view.getUint16(42,!0)},set:function(e){this.view.setUint16(42,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"majorImageVersion",{get:function(){return this.view.getUint16(44,!0)},set:function(e){this.view.setUint16(44,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minorImageVersion",{get:function(){return this.view.getUint16(46,!0)},set:function(e){this.view.setUint16(46,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"majorSubsystemVersion",{get:function(){return this.view.getUint16(48,!0)},set:function(e){this.view.setUint16(48,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minorSubsystemVersion",{get:function(){return this.view.getUint16(50,!0)},set:function(e){this.view.setUint16(50,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"win32VersionValue",{get:function(){return this.view.getUint32(52,!0)},set:function(e){this.view.setUint32(52,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfImage",{get:function(){return this.view.getUint32(56,!0)},set:function(e){this.view.setUint32(56,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfHeaders",{get:function(){return this.view.getUint32(60,!0)},set:function(e){this.view.setUint32(60,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"checkSum",{get:function(){return this.view.getUint32(64,!0)},set:function(e){this.view.setUint32(64,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"subsystem",{get:function(){return this.view.getUint16(68,!0)},set:function(e){this.view.setUint16(68,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dllCharacteristics",{get:function(){return this.view.getUint16(70,!0)},set:function(e){this.view.setUint16(70,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfStackReserve",{get:function(){return E(this.view,72)},set:function(e){R(this.view,72,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfStackReserveBigInt",{get:function(){return I(this.view,72)},set:function(e){T(this.view,72,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfStackCommit",{get:function(){return E(this.view,80)},set:function(e){R(this.view,80,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfStackCommitBigInt",{get:function(){return I(this.view,80)},set:function(e){T(this.view,80,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfHeapReserve",{get:function(){return E(this.view,88)},set:function(e){R(this.view,88,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfHeapReserveBigInt",{get:function(){return I(this.view,88)},set:function(e){T(this.view,88,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfHeapCommit",{get:function(){return E(this.view,96)},set:function(e){R(this.view,96,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeOfHeapCommitBigInt",{get:function(){return I(this.view,96)},set:function(e){T(this.view,96,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loaderFlags",{get:function(){return this.view.getUint32(104,!0)},set:function(e){this.view.setUint32(104,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"numberOfRvaAndSizes",{get:function(){return this.view.getUint32(108,!0)},set:function(e){this.view.setUint32(108,e,!0)},enumerable:!1,configurable:!0}),t.size=112,t.DEFAULT_MAGIC=523,t}(r);var H=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();const B=function(e){function t(t){return e.call(this,t)||this}return H(t,e),t.from=function(e,n){void 0===n&&(n=0);var i=h(e,n+z.size,6).getUint16(4,!0),r=4+z.size+c.size;return i===C.DEFAULT_MAGIC?r+=C.size:r+=S.size,new t(h(e,n,r))},t.prototype.isValid=function(){return this.signature===t.DEFAULT_SIGNATURE},t.prototype.is32bit=function(){return this.view.getUint16(z.size+4,!0)===S.DEFAULT_MAGIC},Object.defineProperty(t.prototype,"signature",{get:function(){return this.view.getUint32(0,!0)},set:function(e){this.view.setUint32(0,e,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fileHeader",{get:function(){return z.from(this.view.buffer,this.view.byteOffset+4)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"optionalHeader",{get:function(){var e=z.size+4;return this.view.getUint16(e,!0)===C.DEFAULT_MAGIC?C.from(this.view.buffer,this.view.byteOffset+e):S.from(this.view.buffer,this.view.byteOffset+e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"optionalHeaderDataDirectory",{get:function(){return c.from(this.view.buffer,this.view.byteOffset+this.getDataDirectoryOffset())},enumerable:!1,configurable:!0}),t.prototype.getDataDirectoryOffset=function(){var e=z.size+4;return this.view.getUint16(e,!0)===C.DEFAULT_MAGIC?e+=C.size:e+=S.size,e},t.prototype.getSectionHeaderOffset=function(){return this.getDataDirectoryOffset()+c.size},t.DEFAULT_SIGNATURE=17744,t}(r);var V=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();const L=function(e){function t(t,n){var i=e.call(this,t)||this;return i.length=n,i}return V(t,e),t.from=function(e,n,i){return void 0===i&&(i=0),new t(new DataView(e,i,40*n),n)},t.prototype.get=function(e){return{name:m(this.view,40*e,8),virtualSize:this.view.getUint32(8+40*e,!0),virtualAddress:this.view.getUint32(12+40*e,!0),sizeOfRawData:this.view.getUint32(16+40*e,!0),pointerToRawData:this.view.getUint32(20+40*e,!0),pointerToRelocations:this.view.getUint32(24+40*e,!0),pointerToLineNumbers:this.view.getUint32(28+40*e,!0),numberOfRelocations:this.view.getUint16(32+40*e,!0),numberOfLineNumbers:this.view.getUint16(34+40*e,!0),characteristics:this.view.getUint32(36+40*e,!0)}},t.prototype.set=function(e,t){!function(e,t,n,i){if("undefined"!=typeof Buffer){var r=new Uint8Array(e.buffer,e.byteOffset+t,8);r.set(new Uint8Array(8)),r.set(Buffer.from(i,"utf8").subarray(0,8))}else if("undefined"!=typeof encodeURIComponent)for(var o=encodeURIComponent(i),s=0,a=0;s<8;++s)if(a>=o.length)e.setUint8(s+t,0);else if(37===(u=o.charCodeAt(a))){var f=parseInt(o.substr(a+1,2),16);"number"!=typeof f||isNaN(f)?e.setUint8(s+t,0):e.setUint8(s+t,f),a+=3}else e.setUint8(s+t,u);else for(s=0,a=0;s<8;++s)if(a>=i.length)e.setUint8(s+t,0);else{var u=i.charCodeAt(a);e.setUint8(s+t,255&u)}}(this.view,40*e,0,t.name),this.view.setUint32(8+40*e,t.virtualSize,!0),this.view.setUint32(12+40*e,t.virtualAddress,!0),this.view.setUint32(16+40*e,t.sizeOfRawData,!0),this.view.setUint32(20+40*e,t.pointerToRawData,!0),this.view.setUint32(24+40*e,t.pointerToRelocations,!0),this.view.setUint32(28+40*e,t.pointerToLineNumbers,!0),this.view.setUint16(32+40*e,t.numberOfRelocations,!0),this.view.setUint16(34+40*e,t.numberOfLineNumbers,!0),this.view.setUint32(36+40*e,t.characteristics,!0)},t.itemSize=40,t}(f);var x=new Uint8Array([14,31,186,14,0,180,9,205,33,184,1,76,205,33,68,79,83,32,109,111,100,101,32,110,111,116,32,115,117,112,112,111,114,116,101,100,46,13,13,10,36,0,0,0,0,0,0,0]),k=y(j.size+x.length,128);const F=function(){function e(e,t,n){this._headers=e,this._sections=t,this._ex=n;var i=j.from(e),r=B.from(e,i.newHeaderAddress);this._dh=i,this._nh=r,this._dda=r.optionalHeaderDataDirectory,t.sort((function(e,t){var n=e.info.pointerToRawData,i=e.info.pointerToRawData;if(n!==i)return n-i;var r=e.info.virtualAddress,o=t.info.virtualAddress;return r===o?e.info.virtualSize-t.info.virtualSize:r-o}))}return e.createEmpty=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!0),this.from(function(e,t){var n=y(k+function(e){return 4+z.size+(e?S.size:C.size)+c.size}(e),512),i=new ArrayBuffer(n);return function(e){var t=j.from(e);t.magic=j.DEFAULT_MAGIC,t.lastPageSize=k%512,t.pages=Math.ceil(k/512),t.relocations=0,t.headerSizeInParagraph=Math.ceil(j.size/16),t.minAllocParagraphs=0,t.maxAllocParagraphs=65535,t.initialSS=0,t.initialSP=128,t.relocationTableAddress=j.size,t.newHeaderAddress=k,v(e,j.size,x,0,x.length)}(i),function(e,t,n,i,r){var o,s;"buffer"in e?(o=e.buffer,s=e.byteOffset+t):(o=e,s=t),new DataView(o,s).setUint32(0,B.DEFAULT_SIGNATURE,!0);var a=z.from(o,s+4);a.machine=i?332:34404,a.numberOfSections=0,a.timeDateStamp=0,a.pointerToSymbolTable=0,a.numberOfSymbols=0,a.sizeOfOptionalHeader=(i?S.size:C.size)+c.size,a.characteristics=r?8450:258;var f=(i?S:C).from(o,s+4+z.size);f.magic=i?S.DEFAULT_MAGIC:C.DEFAULT_MAGIC,f.sizeOfCode=0,f.sizeOfInitializedData=0,f.sizeOfUninitializedData=0,f.addressOfEntryPoint=0,f.baseOfCode=4096,f.imageBase=i?16777216:6442450944,f.sectionAlignment=4096,f.fileAlignment=512,f.majorOperatingSystemVersion=6,f.minorOperatingSystemVersion=0,f.majorSubsystemVersion=6,f.minorSubsystemVersion=0,f.sizeOfHeaders=y(n,f.fileAlignment),f.subsystem=2,f.dllCharacteristics=64+(i?0:32)+256,f.sizeOfStackReserve=1048576,f.sizeOfStackCommit=4096,f.sizeOfHeapReserve=1048576,f.sizeOfHeapCommit=4096,f.numberOfRvaAndSizes=c.size/c.itemSize}(i,k,n,e,t),i}(e,t))},e.from=function(t,n){var i=j.from(t),r=B.from(t,i.newHeaderAddress);if(!i.isValid()||!r.isValid())throw new TypeError("Invalid binary format");if(r.fileHeader.numberOfSymbols>0)throw new Error("Binary with symbols is not supported now");var o=r.optionalHeader.fileAlignment,s=r.optionalHeaderDataDirectory.get(l.Certificate);if(s.size>0&&!(null==n?void 0:n.ignoreCert))throw new Error("Parsing signed executable binary is not allowed by default.");var a=i.newHeaderAddress+r.getSectionHeaderOffset(),f=r.fileHeader.numberOfSections,u=[],c=b(t,a,f*L.itemSize),p=L.from(c,f,0),g=y(a+f*L.itemSize,o);p.forEach((function(e){if(e.pointerToRawData&&e.sizeOfRawData){var n=b(t,e.pointerToRawData,e.sizeOfRawData);u.push({info:e,data:n});var i=y(e.pointerToRawData+e.sizeOfRawData,o);i>g&&(g=i)}else e.pointerToRawData=0,e.sizeOfRawData=0,u.push({info:e,data:null})}));var h=b(t,0,a),d=null,v=t.byteLength;return s.size>0&&(v=s.virtualAddress),g<v&&(d=b(t,g,v-g)),new e(h,u,d)},e.prototype.is32bit=function(){return this._nh.is32bit()},e.prototype.getTotalHeaderSize=function(){return this._headers.byteLength},Object.defineProperty(e.prototype,"dosHeader",{get:function(){return this._dh},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newHeader",{get:function(){return this._nh},enumerable:!1,configurable:!0}),e.prototype.getRawHeader=function(){return this._headers},e.prototype.getImageBase=function(){return this._nh.optionalHeader.imageBase},e.prototype.getFileAlignment=function(){return this._nh.optionalHeader.fileAlignment},e.prototype.getSectionAlignment=function(){return this._nh.optionalHeader.sectionAlignment},e.prototype.getAllSections=function(){return this._sections},e.prototype.getSectionByEntry=function(e){var t=this._dda.get(e),n=this._sections.filter((function(e){var n=e.info.virtualAddress+e.info.virtualSize;return t.virtualAddress>=e.info.virtualAddress&&t.virtualAddress<n})).shift();return void 0!==n?n:null},e.prototype.setSectionByEntry=function(e,t){var n=t?{data:t.data,info:t.info}:null,i=this._dda.get(e),r=i.size>0;if(n){var o=n.data?n.data.byteLength:0,s=this._nh.optionalHeader.fileAlignment,a=this._nh.optionalHeader.sectionAlignment,f=n.data?y(o,s):0,u=n.data?y(n.info.virtualSize,a):0;if(n.info.sizeOfRawData<f?n.info.sizeOfRawData=f:f=n.info.sizeOfRawData,r)this.replaceSectionImpl(i.virtualAddress,n.info,n.data);else{var c=0,p=y(this._headers.byteLength,s);this._sections.forEach((function(e){e.info.pointerToRawData&&p<=e.info.pointerToRawData&&(p=e.info.pointerToRawData+e.info.sizeOfRawData),c<=e.info.virtualAddress&&(c=e.info.virtualAddress+e.info.virtualSize)})),f||(p=0),c||(c=this.newHeader.optionalHeader.baseOfCode),c=y(c,a),n.info.pointerToRawData=p,n.info.virtualAddress=c,this._dda.set(e,{size:o,virtualAddress:c}),this._sections.push(n),this._nh.fileHeader.numberOfSections=this._sections.length,this._nh.optionalHeader.sizeOfImage=y(c+u,this._nh.optionalHeader.sectionAlignment)}}else if(r){this._dda.set(e,{size:0,virtualAddress:0});for(var l=this._sections.length,g=0;g<l;++g){var h=this._sections[g],d=h.info.virtualAddress,v=d+h.info.virtualSize;if(i.virtualAddress>=d&&i.virtualAddress<v){this._sections.splice(g,1),this._nh.fileHeader.numberOfSections=this._sections.length;break}}}},e.prototype.getExtraData=function(){return this._ex},e.prototype.setExtraData=function(e){this._ex=null===e?null:w(e)},e.prototype.generate=function(e){var t=this._dh,n=this._nh,i=t.newHeaderAddress+n.getSectionHeaderOffset(),r=i;r+=this._sections.length*L.itemSize;var o=n.optionalHeader.fileAlignment;r=y(r,o),this._sections.forEach((function(e){if(e.info.pointerToRawData){var t=e.info.pointerToRawData+e.info.sizeOfRawData;r<t&&(r=y(r=t,o))}}));var s=r;null!==this._ex&&(r+=this._ex.byteLength),"number"==typeof e&&(r+=e);var a=new ArrayBuffer(r),f=new Uint8Array(a);f.set(new Uint8Array(this._headers,0,i)),c.from(a,t.newHeaderAddress+n.getDataDirectoryOffset()).set(l.Certificate,{size:0,virtualAddress:0});var u=L.from(a,this._sections.length,i);return this._sections.forEach((function(e,t){e.data||(e.info.pointerToRawData=0,e.info.sizeOfRawData=0),u.set(t,e.info),e.data&&e.info.pointerToRawData&&f.set(new Uint8Array(e.data),e.info.pointerToRawData)})),null!==this._ex&&f.set(new Uint8Array(this._ex),s),0!==n.optionalHeader.checkSum&&d(a,!0),a},e.prototype.rearrangeSections=function(e,t,n,i){if(t||i){for(var r=this._nh,o=r.optionalHeader.sectionAlignment,s=this._dda,a=this._sections.length,f=0,u=0;u<a;++u){var c=this._sections[u],p=c.info.virtualAddress;if(i&&p>=n){var l=s.findIndexByVirtualAddress(p);p+=i,null!==l&&s.set(l,{virtualAddress:p,size:c.info.virtualSize}),c.info.virtualAddress=p}var g=c.info.pointerToRawData;t&&g>=e&&(c.info.pointerToRawData=g+t),f=y(c.info.virtualAddress+c.info.virtualSize,o)}r.optionalHeader.sizeOfImage=f}},e.prototype.replaceSectionImpl=function(e,t,n){for(var i=this._sections.length,r=0;r<i;++r){var o=this._sections[r];if(o.info.virtualAddress===e){var s=this._nh.optionalHeader.sectionAlignment,a=o.info.pointerToRawData,f=a+o.info.sizeOfRawData,u=e+y(o.info.virtualSize,s);o.info=g(t),o.info.virtualAddress=e,o.info.pointerToRawData=a,o.data=n;var c=a+t.sizeOfRawData,p=e+y(t.virtualSize,s);this.rearrangeSections(f,c-f,u,p-u);var l=this._dda,h=l.findIndexByVirtualAddress(e);null!==h&&l.set(h,{virtualAddress:e,size:t.virtualSize});break}}},e}();function N(e,t){var n=e.getUint16(t,!0),i="";t+=2;for(var r=0;r<n;++r)i+=String.fromCharCode(e.getUint16(t,!0)),t+=2;return i}function M(e,t,n,i,r){var o=i,s={name:n,languageTable:i,characteristics:e.getUint32(o,!0),dateTime:e.getUint32(o+4,!0),majorVersion:e.getUint16(o+8,!0),minorVersion:e.getUint16(o+10,!0)},a=e.getUint16(o+12,!0),f=e.getUint16(o+14,!0);o+=16;for(var u=0;u<a;++u){var c=2147483647&e.getUint32(o,!0);2147483648&(p=e.getUint32(o+4,!0))||r(t,s,{lang:N(e,c),dataOffset:p}),o+=8}for(u=0;u<f;++u){var p,l=2147483647&e.getUint32(o,!0);2147483648&(p=e.getUint32(o+4,!0))||r(t,s,{lang:l,dataOffset:p}),o+=8}}function G(e,t,n,i){var r=n,o={type:t,nameTable:n,characteristics:e.getUint32(r,!0),dateTime:e.getUint32(r+4,!0),majorVersion:e.getUint16(r+8,!0),minorVersion:e.getUint16(r+10,!0)},s=e.getUint16(r+12,!0),a=e.getUint16(r+14,!0);r+=16;for(var f=0;f<s;++f){var u=2147483647&e.getUint32(r,!0);2147483648&(c=e.getUint32(r+4,!0))?(c&=2147483647,M(e,o,N(e,u),c,i),r+=8):r+=8}for(f=0;f<a;++f){var c,p=2147483647&e.getUint32(r,!0);2147483648&(c=e.getUint32(r+4,!0))?(M(e,o,p,c&=2147483647,i),r+=8):r+=8}}function X(e,t,n){var i={},r={};n.forEach((function(e){"string"==typeof e.lang?(i[e.lang]=e,t.push(e.lang)):r[e.lang]=e}));var o=Object.keys(i);o.sort().forEach((function(t){e.s.push(i[t])}));var s=Object.keys(r);return s.map((function(e){return Number(e)})).sort((function(e,t){return e-t})).forEach((function(t){e.n.push(r[t])})),16+8*(o.length+s.length)}function q(e,t,n){var i={},r={};return n.forEach((function(e){var n,o;if("string"==typeof e.id){var s=null!==(n=i[e.id])&&void 0!==n?n:i[e.id]=[];t.push(e.id),s.push(e)}else(s=null!==(o=r[e.id])&&void 0!==o?o:r[e.id]=[]).push(e)})),16+Object.keys(i).sort().map((function(n){var r={id:n,s:[],n:[]};return e.s.push(r),X(r,t,i[n])})).reduce((function(e,t){return e+8+t}),0)+Object.keys(r).map((function(e){return Number(e)})).sort((function(e,t){return e-t})).map((function(n){var i={id:n,s:[],n:[]};return e.n.push(i),X(i,t,r[n])})).reduce((function(e,t){return e+8+t}),0)}function J(e){var t=e.length;return t>65535?65535:t}function K(e,t){for(var n=t.length,i=0;i<n;++i){var r=t[i];if(r.text===e)return r.offset}throw new Error("Unexpected")}function Q(e,t,n,i){return e.setUint32(t,0,!0),e.setUint32(t+4,0,!0),e.setUint32(t+8,0,!0),e.setUint16(t+12,i.s.length,!0),e.setUint16(t+14,i.n.length,!0),t+=16,i.s.forEach((function(i){var r=K(i.lang,n);e.setUint32(t,r,!0),e.setUint32(t+4,i.offset,!0),t+=8})),i.n.forEach((function(n){e.setUint32(t,n.lang,!0),e.setUint32(t+4,n.offset,!0),t+=8})),t}function W(e,t,n,i,r){return e.setUint32(t,0,!0),e.setUint32(t+4,0,!0),e.setUint32(t+8,0,!0),e.setUint16(t+12,r.s.length,!0),e.setUint16(t+14,r.n.length,!0),t+=16,r.s.forEach((function(t){t.offset=n,n=Q(e,n,i,t)})),r.n.forEach((function(t){t.offset=n,n=Q(e,n,i,t)})),r.s.forEach((function(n){var r=K(n.id,i);e.setUint32(t,r+2147483648,!0),e.setUint32(t+4,n.offset+2147483648,!0),t+=8})),r.n.forEach((function(n){e.setUint32(t,n.id,!0),e.setUint32(t+4,n.offset+2147483648,!0),t+=8})),n}const Y=function(){function e(){this.dateTime=0,this.majorVersion=0,this.minorVersion=0,this.entries=[],this.sectionDataHeader=null,this.originalSize=0}return e.prototype.parse=function(e,t){if(e.data){var n=new DataView(e.data);this.dateTime=n.getUint32(4,!0),this.majorVersion=n.getUint16(8,!0),this.minorVersion=n.getUint16(10,!0);for(var i=n.getUint16(12,!0),r=n.getUint16(14,!0),o=16,s=[],a=function(i,r,o){var a=n.getUint32(o.dataOffset,!0)-e.info.virtualAddress,f=n.getUint32(o.dataOffset+4,!0),u=n.getUint32(o.dataOffset+8,!0);if(a>=0){var c=new Uint8Array(f);c.set(new Uint8Array(e.data,a,f)),s.push({type:i.type,id:r.name,lang:o.lang,codepage:u,bin:c.buffer})}else{if(!t)throw new Error("Cannot parse resource directory entry; RVA seems to be invalid.");s.push({type:i.type,id:r.name,lang:o.lang,codepage:u,bin:new ArrayBuffer(0),rva:o.dataOffset})}},f=0;f<i;++f){var u=2147483647&n.getUint32(o,!0);if(2147483648&(p=n.getUint32(o+4,!0))){p&=2147483647;var c=N(n,u);G(n,c,p,a),o+=8}else o+=8}for(f=0;f<r;++f){var p,l=2147483647&n.getUint32(o,!0);2147483648&(p=n.getUint32(o+4,!0))?(G(n,l,p&=2147483647,a),o+=8):o+=8}this.entries=s,this.originalSize=e.data.byteLength}},e.from=function(t,n){void 0===n&&(n=!1);var i=[].concat(t.getAllSections()).sort((function(e,t){return e.info.virtualAddress-t.info.virtualAddress})),r=t.getSectionByEntry(l.Resource);if(r)for(var o=t.getSectionByEntry(l.BaseRelocation),s=0;s<i.length;++s)if(i[s]===r){for(var a=s+1;a<i.length;++a)if(!o||i[a]!==o)throw new Error("After Resource section, sections except for relocation are not supported");break}var f=new e;return f.sectionDataHeader=r?g(r.info):null,r&&f.parse(r,n),f},e.prototype.replaceResourceEntry=function(e){for(var t=this.entries.length,n=0;n<t;++n){var i=this.entries[n];if(i.type===e.type&&i.id===e.id&&i.lang===e.lang)return void(this.entries[n]=e)}this.entries.push(e)},e.prototype.getResourceEntriesAsString=function(e,t){return this.entries.filter((function(n){return n.type===e&&n.id===t})).map((function(e){return[e.lang,U(e.bin)]}))},e.prototype.replaceResourceEntryFromString=function(e,t,n,i){var r={type:e,id:t,lang:n,codepage:1200,bin:O(i)};this.replaceResourceEntry(r)},e.prototype.removeResourceEntry=function(e,t,n){this.entries=this.entries.filter((function(i){return!(i.type===e&&i.id===t&&(void 0===n||i.lang===n))}))},e.prototype.generateResourceData=function(e,t,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1);var r={s:[],n:[]},o=[],s=function(e,t,n){var i={},r={};return n.forEach((function(e){var n,o;if("string"==typeof e.type){var s=null!==(n=i[e.type])&&void 0!==n?n:i[e.type]=[];t.push(e.type),s.push(e)}else(s=null!==(o=r[e.type])&&void 0!==o?o:r[e.type]=[]).push(e)})),16+Object.keys(i).sort().map((function(n){var r={type:n,s:[],n:[]};return e.s.push(r),q(r,t,i[n])})).reduce((function(e,t){return e+8+t}),0)+Object.keys(r).map((function(e){return Number(e)})).sort((function(e,t){return e-t})).map((function(n){var i={type:n,s:[],n:[]};return e.n.push(i),q(i,t,r[n])})).reduce((function(e,t){return e+8+t}),0)}(r,o,this.entries),a=s,f=s=y(s+=(o=o.reduce((function(e,t){return e.indexOf(t)>=0?e:e.concat(t)}),[])).reduce((function(e,t){return e+2+2*J(t)}),0),8),u=s=this.entries.reduce((function(e,t){return t.offset=e,e+16}),f);s=this.entries.reduce((function(e,t){return y(e,8)+t.bin.byteLength}),u);var c=y(s,t),p=y(this.originalSize,t);if(n&&c>p)throw new Error("New resource data is larger than original");i||c<p&&(c=p);var l=new ArrayBuffer(c),g=new DataView(l),h=f,d=e+u;this.entries.forEach((function(e){var t=e.bin.byteLength;void 0!==e.rva?g.setUint32(h,e.rva,!0):(d=y(d,8),g.setUint32(h,d,!0),d+=t),g.setUint32(h+4,t,!0),g.setUint32(h+8,e.codepage,!0),g.setUint32(h+12,0,!0),h+=16})),h=u,this.entries.forEach((function(e){var t=e.bin.byteLength;v(l,h,e.bin,0,t),h+=y(t,8)}));var b=[];if(h=a,o.forEach((function(e){b.push({offset:h,text:e}),h=function(e,t,n){var i=J(n);e.setUint16(t,i,!0),t+=2;for(var r=0;r<i;++r)e.setUint16(t,n.charCodeAt(r),!0),t+=2;return t}(g,h,e)})),function(e,t,n,i){e.setUint32(t,0,!0),e.setUint32(t+4,0,!0),e.setUint32(t+8,0,!0),e.setUint16(t+12,i.s.length,!0),e.setUint16(t+14,i.n.length,!0);var r=(t+=16)+8*(i.s.length+i.n.length);i.s.forEach((function(e){e.offset=r,r+=16+8*(e.s.length+e.n.length)})),i.n.forEach((function(e){e.offset=r,r+=16+8*(e.s.length+e.n.length)})),i.s.forEach((function(i){var o=K(i.type,n);e.setUint32(t,o+2147483648,!0),e.setUint32(t+4,i.offset+2147483648,!0),t+=8,r=W(e,i.offset,r,n,i)})),i.n.forEach((function(i){e.setUint32(t,i.type,!0),e.setUint32(t+4,i.offset+2147483648,!0),t+=8,r=W(e,i.offset,r,n,i)}))}(g,0,b,r),c>s)for(var w=s,m=0;w<c;++w,++m)8===m&&(m=0),g.setUint8(w,"PADDINGX".charCodeAt(m));return{bin:l,rawSize:s,dataOffset:u,descEntryOffset:f,descEntryCount:this.entries.length}},e.prototype.outputResource=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var i,r=e.getFileAlignment();i=this.sectionDataHeader?{data:null,info:g(this.sectionDataHeader)}:{data:null,info:{name:".rsrc",virtualSize:0,virtualAddress:0,sizeOfRawData:0,pointerToRawData:0,pointerToRelocations:0,pointerToLineNumbers:0,numberOfRelocations:0,numberOfLineNumbers:0,characteristics:1073741888}};var o=this.generateResourceData(0,r,t,n);i.data=o.bin,i.info.sizeOfRawData=o.bin.byteLength,i.info.virtualSize=o.rawSize,e.setSectionByEntry(l.Resource,i);for(var s=e.getSectionByEntry(l.Resource),a=new DataView(s.data),f=o.descEntryOffset,u=s.info.virtualAddress+o.dataOffset,c=0;c<o.descEntryCount;++c){var p=a.getUint32(f+4,!0);u=y(u,8),a.setUint32(f,u,!0),u+=p,f+=16}},e}(),Z="1.0.1";function $(e){return j.from(e)}function ee(e,t){return B.from(e,t.newHeaderAddress)}function te(e,t,n){return L.from(e,n.fileHeader.numberOfSections,t.newHeaderAddress+n.byteLength)}function ne(e,t,n,i){for(var r=L.from(e,n.fileHeader.numberOfSections,t.newHeaderAddress+n.byteLength),o=r.length,s=n.optionalHeaderDataDirectory.get(i).virtualAddress,a=0;a<o;++a){var f=r.get(a),u=f.virtualAddress+f.virtualSize;if(s>=f.virtualAddress&&s<u){var c=f.pointerToRawData;return c?e.slice(c,c+f.sizeOfRawData):null}if(s<f.virtualAddress)return null}return null}}}]);